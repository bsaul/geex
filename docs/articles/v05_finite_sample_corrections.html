<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finite sample correction API in `geex` • geex</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Finite sample correction API in `geex`">
<meta property="og:description" content="geex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bsaul/geex" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Finite sample correction API in
<code>geex</code>
</h1>
                        <h4 data-toc-skip class="author">Bradley
Saul</h4>
            
            <h4 data-toc-skip class="date">2022-07-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bsaul/geex/blob/HEAD/vignettes/v05_finite_sample_corrections.Rmd" class="external-link"><code>vignettes/v05_finite_sample_corrections.Rmd</code></a></small>
      <div class="hidden name"><code>v05_finite_sample_corrections.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The empirical sandwich variance estimator is known to underestimate
<span class="math inline">\(V(\theta)\)</span> in small samples <span class="citation">(Fay and Graubard 2001)</span>. Particularly in the
context of GEE, <a href="https://bsaul.github.io/geex/articles/articles/mestimation_bib.html" class="external-link">many
authors</a> have proposed corrections that modify components of <span class="math inline">\(\hat{\Sigma}\)</span> and/or by assuming <span class="math inline">\(\hat{\theta}\)</span> follows a <span class="math inline">\(t\)</span> (or <span class="math inline">\(F\)</span>), as opposed to Normal, distribution
with some estimated degrees of freedom. Many of the proposed corrections
somehow modify a combination of the <span class="math inline">\(A_i\)</span>, <span class="math inline">\(A_m\)</span>, <span class="math inline">\(B_i\)</span>, or <span class="math inline">\(B_m\)</span> matrices.</p>
<p><code>geex</code> provides an API that allows users to specify
functions that utilize these matrices to form corrections. A finite
sample correction function at a minimum takes the argument
<code>components</code>, which is an object of class
<code>sandwich_components</code>. For example,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">correct_by_nothing</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">components</span><span class="op">)</span><span class="op">{</span>
  <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab_bread-methods.html">grab_bread</a></span><span class="op">(</span><span class="va">components</span><span class="op">)</span>
  <span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab_meat-methods.html">grab_meat</a></span><span class="op">(</span><span class="va">components</span><span class="op">)</span>
  <span class="fu"><a href="../reference/compute_sigma.html">compute_sigma</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, B <span class="op">=</span> <span class="va">B</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>is a correctly formed function that does no corrections. Additional
arguments may also be specified, as shown in the example.</p>
</div>
<div class="section level2">
<h2 id="corrections-included-with-geex">Corrections included with <code>geex</code><a class="anchor" aria-label="anchor" href="#corrections-included-with-geex"></a>
</h2>
<p>The <code>geex</code> package includes the bias correction and
degrees of freedom corrections proposed by <span class="citation">Fay
and Graubard (2001)</span> in the <code>correct_by_fay_bias</code> and
<code>correct_by_fay_df</code> functions respectively. The following
demonstrates the construction and use of the bias correction. <span class="citation">Fay and Graubard (2001)</span> proposed the modified
variance estimator <span class="math inline">\(\hat{\Sigma}^{bc}(b) =
A_m^{-1} B_m^{bc}(b) \{A_m^{-1}\}^{\intercal}/m\)</span>, where:</p>
<p><span class="math display">\[\begin{equation}
\label{eq:bc}
B^{bc}_m(b) = \sum_{i = 1}^m H_i(b) B_i H_i(b)^{\intercal},
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\label{eq:H}
H_i(b) = \{1 - \min(b, \{A_i A^{-1}\}_{jj}) \}^{-1/2},
\end{equation}\]</span></p>
<p>and <span class="math inline">\(W_{jj}\)</span> is the <span class="math inline">\((j, j)\)</span> element of a matrix <span class="math inline">\(W\)</span>. When <span class="math inline">\(\{A_i
A^{-1}\}_{jj}\)</span> is close to 1, the adjustment to <span class="math inline">\(\hat{\Sigma}^{bc}(b)\)</span> may be extreme, and
the constant <span class="math inline">\(b\)</span> is chosen by the
analyst to limit over adjustments.</p>
</div>
<div class="section level2">
<h2 id="bias-correction-example">Bias correction example<a class="anchor" aria-label="anchor" href="#bias-correction-example"></a>
</h2>
<p>The bias corrected estimator <span class="math inline">\(\hat{\Sigma}^{bc}(b)\)</span> can be implemented
in <code>geex</code> by the following function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bias_correction</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">components</span>, <span class="va">b</span><span class="op">)</span><span class="op">{</span>
  <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab_bread-methods.html">grab_bread</a></span><span class="op">(</span><span class="va">components</span><span class="op">)</span>
  <span class="va">A_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab_bread_list-methods.html">grab_bread_list</a></span><span class="op">(</span><span class="va">components</span><span class="op">)</span>
  <span class="va">B_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab_meat_list-methods.html">grab_meat_list</a></span><span class="op">(</span><span class="va">components</span><span class="op">)</span>
  <span class="va">Ainv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>

  <span class="va">H_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">A_i</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">m</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="va">Ainv</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>

  <span class="va">Bbc_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">B_i</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span>
    <span class="va">H_i</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="va">B_i</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="va">H_i</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span><span class="op">)</span>
  <span class="va">Bbc</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></span><span class="op">(</span><span class="va">Bbc_i</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span>

  <span class="fu"><a href="../reference/compute_sigma.html">compute_sigma</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, B <span class="op">=</span> <span class="va">Bbc</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The <code>compute_sigma</code> function simply computes <span class="math inline">\(A^{-1} B \{A^{-1}\}^{\intercal}\)</span>. Note
that <code>geex</code> computes <span class="math inline">\(A_m\)</span>
and <span class="math inline">\(B_m\)</span> as the sums of <span class="math inline">\(A_i\)</span> and <span class="math inline">\(B_i\)</span> rather than the means, hence the
appropriate function in the <code>apply</code> call is <code>sum</code>
and not <code>mean</code>. To use this bias correction, the
<code>m_estimate</code> function accepts a named list of corrections to
perform. Each element of the list is also a list with two elements:
<code>correctFUN</code>, the correction function; and
<code>correctFUN_control</code>, a list of arguments passed to the
<code>correctFUN</code> besides <code>A</code>, <code>A_i</code>,
<code>B</code>, and <code>B_i</code>.</p>
</div>
<div class="section level2">
<h2 id="comparision-to-saws-package">Comparision to saws package<a class="anchor" aria-label="anchor" href="#comparision-to-saws-package"></a>
</h2>
<p>Here we compare the <code>geex</code> implementation of GEE with an
exchangeable correlation matrix to Fay’s <code>saws</code> package.</p>
<p>The estimating functions are:</p>
<p><span class="math display">\[\begin{equation}
\label{gee}
\sum_{i= 1}^m \psi(\mathbf{Y}_i, \mathbf{X}_i, \beta) = \sum_{i = 1}^m
\mathbf{D}_i^{\intercal} \mathbf{V}_i^{-1} (\mathbf{Y}_i -
\mathbf{\mu}(\beta)) = 0
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathbf{D}_i = \partial
\mathbf{\mu}/\partial \mathbf{\beta}\)</span>. The covariance matrix is
modeled by <span class="math inline">\(\mathbf{V}_i = \phi
\mathbf{A}_i^{0.5} \mathbf{R}(\alpha) \mathbf{A}_i^{0.5}\)</span>. The
matrix <span class="math inline">\(\mathbf{R}(\alpha)\)</span> is the
“working” correlation matrix, which in this example is an exchangeable
matrix with off diagonal elements <span class="math inline">\(\alpha\)</span>. The matrix <span class="math inline">\(\mathbf{A}_i\)</span> is a diagonal matrix with
elements containing the variance functions of <span class="math inline">\(\mu\)</span>. The equations in <span class="math inline">\(\eqref{gee}\)</span> can be translated into an
<code>eeFUN</code> as:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gee_eefun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">formula</span>, <span class="va">family</span><span class="op">)</span><span class="op">{</span>
  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>
  <span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.response</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">)</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
  <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">alpha</span>, <span class="va">psi</span><span class="op">)</span><span class="op">{</span>
    <span class="va">mu</span>  <span class="op">&lt;-</span> <span class="va">family</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">)</span>
    <span class="va">Dt</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
    <span class="va">A</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">family</span><span class="op">$</span><span class="fu">variance</span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
    <span class="va">R</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">alpha</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span>
    <span class="va">V</span>   <span class="op">&lt;-</span> <span class="va">psi</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="va">R</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span>
    <span class="va">Dt</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">Y</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>This <code>eeFUN</code> treats the correlation parameter <span class="math inline">\(\alpha\)</span> and scale parameter <span class="math inline">\(\phi\)</span> as fixed, though some estimation
algorithms use an iterative procedure that alternates between estimating
<span class="math inline">\(\beta\)</span> and these parameters. By
customizing the root finding function, such an algorithm could be
implemented using <code>geex</code> [see
<code>vignette("geex_root_solvers")</code> for more information].</p>
<p>We use this example to compare covariance estimates obtained from the
<code>gee</code> function, so root finding computations are turned off.
The <code>gee</code> <span class="math inline">\(\beta\)</span>
estimates are used instead. Estimates for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\phi\)</span> are also extracted from the
<code>gee</code> results in <code>m_estimate</code>. This example shows
that an <code>eeFUN</code> can accept additional arguments to be passed
to either the outer (data) function or the inner (theta) function.
Unlike previous examples, the independent units are the types of wool,
which is set in <code>m_estimate</code> by the <code>units</code>
argument.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gee</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gee/man/gee.html" class="external-link">gee</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">~</span><span class="va">tension</span>, id<span class="op">=</span><span class="va">wool</span>, data<span class="op">=</span><span class="va">warpbreaks</span>, corstr<span class="op">=</span><span class="st">"exchangeable"</span><span class="op">)</span>
<span class="va">guo</span> <span class="op">&lt;-</span> <span class="fu">saws</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/saws/man/geeUOmega.html" class="external-link">geeUOmega</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bsaul/geex" class="external-link">geex</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'geex'</span></code></pre>
<pre><code><span class="co">## The following object is masked from 'package:methods':</span>
<span class="co">## </span>
<span class="co">##     show</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m_estimate.html">m_estimate</a></span><span class="op">(</span>
  estFUN <span class="op">=</span> <span class="va">gee_eefun</span>, data  <span class="op">=</span> <span class="va">warpbreaks</span>, 
  units <span class="op">=</span> <span class="st">'wool'</span>, roots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, compute_roots <span class="op">=</span> <span class="cn">FALSE</span>,
  outer_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">breaks</span> <span class="op">~</span> <span class="va">tension</span>, 
                      family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
  inner_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha   <span class="op">=</span> <span class="va">g</span><span class="op">$</span><span class="va">working.correlation</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, 
                      psi     <span class="op">=</span> <span class="va">g</span><span class="op">$</span><span class="va">scale</span><span class="op">)</span>, 
  corrections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
   bias_correction_.1 <span class="op">=</span> <span class="fu"><a href="../reference/correction.html">correction</a></span><span class="op">(</span><span class="va">bias_correction</span>, b <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,
   bias_correction_.3 <span class="op">=</span> <span class="fu"><a href="../reference/correction.html">correction</a></span><span class="op">(</span><span class="va">bias_correction</span>, b <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>In the <code>geex</code> output, the item <code>corrections</code>
contains a list of the results of computing each item in the
<code>corrections_list</code>. Comparing the <code>geex</code> results
to the results of the <code><a href="https://rdrr.io/pkg/saws/man/geeUOmega.html" class="external-link">saws::geeUOmega</a></code> function, the maximum
difference in the results for any of corrected estimated covariance
matrices is 1.1e-09.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fay2001" class="csl-entry">
Fay, Michael P., and Barry I. Graubard. 2001. <em>Small-Sample
Adjustments for Wald-Type Tests Using Sandwich Estimators</em> 57.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bradley Saul.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
